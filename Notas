https://github.com/gseguierjc/simetrik-demo


aws eks update-kubeconfig --name demo-eks --region us-east-1
kubectl config current-context   # Debe mostrar algo como arn:aws:eks:us-east-1:â€¦/cluster/demo-eks


aws codebuild start-build --project-name demo-grpc-build

kubectl -n grpc-demo-server get pods -o wide
kubectl -n grpc-demo-client get pods -o wide
 kubectl -n grpc-demo-server describe pod service-server-775d56f5fb-vmdtj
 kubectl -n grpc-demo-server logs service-client-5d976d786f-4966h 
 kubectl -n grpc-demo-server delete pod service-server-775d56f5fb-vmdtj

 $ kubectl rollout restart deployment service-server -n grpc-demo-server
kubectl rollout restart deployment service-client -n grpc-demo-client


kubectl -n grpc-demo-client rollout restart deployment service-client
kubectl -n grpc-demo-server rollout restart deployment service-server


para el alb 


# eksctl create iamserviceaccount \
#   --cluster demo-eks \
#   --namespace kube-system \
#   --name aws-load-balancer-controller \
#   --attach-policy-arn arn:aws:iam::aws:policy/AWSLoadBalancerControllerIAMPolicy \
#   --override-existing-serviceaccounts \
#   --approve

aws iam create-policy \
  --policy-name AWSLoadBalancerControllerIAMPolicy \
  --policy-document file://iam_policy.json



kubectl apply -f alb-serviceaccount.yaml

helm repo add eks https://aws.github.io/eks-charts
helm repo update

helm upgrade --install aws-load-balancer-controller eks/aws-load-balancer-controller \
  --namespace kube-system \
  --set clusterName=demo-eks \
  --set region=us-east-1 \
  --set serviceAccount.create=false \
  --set serviceAccount.name=aws-load-balancer-controller
kubectl -n kube-system rollout status deployment aws-load-balancer-controller
kubectl -n kube-system get pods -l app.kubernetes.io/name=aws-load-balancer-controller


kubectl -n kube-system rollout status deployment aws-load-balancer-controller
